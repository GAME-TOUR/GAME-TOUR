import csv
import mysql.connector

# Connect to MySQL
mydb = mysql.connector.connect(
    host="your_host",
    user="your_username",
    password="your_password",
    database="your_database"
)

# Create a cursor object
cursor = mydb.cursor()

# Create the table if it doesn't exist
create_table_query = """
CREATE TABLE IF NOT EXISTS gameinfo (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title CHAR(255),
    title_en CHAR(255),
    date DATE,
    tag JSON,
    description TEXT,
    company CHAR(255),
    publisher CHAR(255),
    platform CHAR(255),
    starpoint DOUBLE
)
"""
cursor.execute(create_table_query)

# CSV file path
csv_file = 'path/to/your/file.csv'

# Open the CSV file
with open(csv_file, 'r') as file:
    csv_reader = csv.DictReader(file)

    # Iterate over each row in the CSV file
    for row in csv_reader:
        # Extract the values from the row, excluding the 'url' column
        title = row['title']
        title_en = row['title_en']
        date = row['date']
        tag = row['tag']
        description = row['description']
        company = row['company']
        publisher = row['publisher']
        platform = row['platform']

        # Prepare the SQL query
        query = "INSERT INTO gameinfo (title, title_en, date, tag, description, company, publisher, platform) VALUES (%s, %s, %s, %s, %s, %s, %s, %s)"
        values = (title, title_en, date, tag, description, company, publisher, platform)

        # Execute the query
        cursor.execute(query, values)

    # Commit the changes and close the connection
    mydb.commit()
    cursor.close()
    mydb.close()

print("Data inserted successfully!")